<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>

<body>
    <h3> 인천광역시 부평구 아파트 전/월세 통계 </h3>
    <table border="1">
        <thead>

        </thead>
        <tbody class="tbody">

        </tbody>
    </table>

    <!-- JQuery 가져오기 -->
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script>
        //  Flask 서버와 통신
        $.ajax({
            method: "get",
            url: "http://192.168.30.239:5000/trans1",
            success: response => {
                console.log(response)
                // 1.
                let thead = document.querySelector('thead') // 1-1 테이블 제목
                // 1-2 제목 구성
                let responseKeys = Object.keys(response)

                let html = `<tr> <th> </th>`
                responseKeys.forEach(key => { html += ` <th> ${key} </th>` })

                html += `</tr>`
                thead.innerHTML = html;  // 1-3 대입

                // 1- 4 내용 구성
                let tbody = document.querySelector('tbody')

                const allDetailKeys = Object.keys(response[responseKeys[0]]);
                let html2 = ``
                // 각 detailKey마다 행을 생성
                allDetailKeys.forEach(detailkey => {
                    html2 += `<tr> <td> ${detailkey} </td>`;
                    // 각 responseKey마다 해당 detailKey의 값을 출력
                    responseKeys.forEach(key => {
                        const keyValue = response[key];
                        html2 += `<td> ${keyValue[detailkey]} </td>`;
                    });
                    html2 += `</tr>`;
                });

                tbody.innerHTML = html2;

                // 1. 테이블 구성
                // 1) 테이블 제목 
                // let thead = document.querySelector(`thead`)
                // // 2) 제목 구성
                // let html = `<tr> 
                //                 <th>
                //                 </th>
                //                 <th>
                //                     NO
                //                 </th>    
                //                 <th>
                //                     건축년도
                //                 </th>    
                //                 <th>
                //                     계약년월
                //                 </th>    
                //                 <th>
                //                     계약일
                //                 </th>    
                //                 <th>
                //                     본번
                //                 </th>    
                //                 <th>
                //                     부번
                //                 </th>    
                //                 <th>
                //                     월세금(만원)
                //                 </th>    
                //                 <th>
                //                     전용면적
                //                 </th>    
                //                 <th>
                //                     종전계약 월세(만원)
                //                 </th>    
                //                 <th>
                //                     층
                //                 </th>    
                //             </tr>`;
                // //  3) 대입
                // thead.innerHTML = html;

                // let tbody = document.querySelector(`tbody`);
                // let html1 = `<tr>
                //                 <th>
                //                     25%
                //                 </th>
                //                 <td>
                //                     ${response["NO"]["25%"]}
                //                 </td>
                //                 <td>
                //                     ${response["건축년도"]["25%"]}
                //                 </td>
                //                 <td>
                //                     ${response["계약년월"]["25%"]}
                //                 </td>
                //                 <td>
                //                     ${response["계약일"]["25%"]}
                //                 </td>
                //                 <td>
                //                     ${response["본번"]["25%"]}
                //                 </td>
                //                 <td>
                //                     ${response["부번"]["25%"]}
                //                 </td>
                //                 <td>
                //                     ${response["월세금(만원)"]["25%"]}
                //                 </td>
                //                 <td>
                //                     ${response["전용면적(㎡)"]["25%"]}
                //                 </td>
                //                 <td>
                //                     ${response["종전계약 월세(만원)"]["25%"]}
                //                 </td>
                //                 <td>
                //                     ${response["층"]["25%"]}
                //                 </td>
                //             </tr>
                //                 `

                // tbody.innerHTML = html1;
                // console.log(response);
                // console.log(Object.keys(response));         // JS 에서 객체 내 모든 key를 호출
                // let resultKeys = Object.keys(response);
                // resultKeys.forEach(key => {
                //     console.log(key);                       // 통계의 필드명
                //     console.log(response[`${key}`]);        // 통계의 각 필드의 값들 
                //     let keyValue = response[`${key}`];
                //     console.log(Object.keys(keyValue));     // 통계 계산, 항목명 ['25%', '50%', '75%', 'count', 'max', 'mean', 'min', 'std']
                //     let tbody = document.querySelector(`tbody`);
                //     let detailKeys = Object.keys(keyValue);
                //     html1 = `<tr>
                //                 <th>
                //                     ${detailKeys[0]}
                //                 </th>
                //             </tr>
                //             <tr>
                //                 <th>
                //                     ${detailKeys[1]}
                //                 </th>
                //             </tr>
                //             <tr>
                //                 <th>
                //                     ${detailKeys[2]}
                //                 </th>
                //             </tr>
                //             <tr>
                //                 <th>
                //                     ${detailKeys[3]}
                //                 </th>
                //             </tr>
                //             <tr>
                //                 <th>
                //                     ${detailKeys[4]}
                //                 </th>
                //             </tr>
                //                 <th>
                //                     ${detailKeys[5]}
                //                 </th>
                //             <tr>
                //                 <th>
                //                     ${detailKeys[6]}
                //                 </th>
                //             </tr>
                //             <tr>
                //                 <th>
                //                     ${detailKeys[7]}
                //                 </th>
                //             </tr>
                //             `;
                //     tbody.innerHTML = html1;
                //     html = ``;
                //     let detailValues = {}
                //     detailKeys.forEach(detailkeys => {

                //         detailValues[`${detailkeys}`] = `${keyValue[`${detailkeys}`]}`
                //         console.log(detailValues)

                //         console.log(detailkeys)
                //         console.log(keyValue[`${detailkeys}`])

                //     })
                //     console.log(detailValues)
                //     // tbody.innerHTML += html;
                // })

            }

        })
    </script>
</body>

</html>